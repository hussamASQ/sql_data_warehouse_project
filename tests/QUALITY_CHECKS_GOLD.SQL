SELECT * FROM SILVER.CRM_CUST_INFO

SELECT 
CI.CST_ID,
CI.CST_KEY,
CI.CST_FIRSTNAME,
CI.CST_LASTNAME,
CI.CST_MARITAL_STATUS,
CI.CST_GNDR,
CI.CST_CREATE_DATE,
CA.BDATE,
CA.GEN,
LA.CNTRY
FROM SILVER.CRM_CUST_INFO CI
LEFT JOIN SILVER.ERP_CUST_AZ12 CA
ON CI.CST_KEY = CA.CID
LEFT JOIN SILVER.ERP_LOC_A101 LA
ON CI.CST_KEY = LA.CID



SELECT CST_ID, COUNT(*) FROM
(SELECT 
CI.CST_ID,
CI.CST_KEY,
CI.CST_FIRSTNAME,
CI.CST_LASTNAME,
CI.CST_GNDR,
CI.CST_CREATE_DATE,
CA.BDATE,
CA.GEN,
LA.CNTRY
FROM SILVER.CRM_CUST_INFO CI
LEFT JOIN SILVER.ERP_CUST_AZ12 CA
ON CI.CST_KEY = CA.CID
LEFT JOIN SILVER.ERP_LOC_A101 LA
ON CI.CST_KEY = LA.CID
) T GROUP BY CST_ID
HAVING COUNT(*) < 1
------------------------------------------------------
SELECT DISTINCT 
CI.CST_GNDR,
CA.GEN
FROM SILVER.CRM_CUST_INFO CI
LEFT JOIN SILVER.ERP_CUST_AZ12 CA
ON  CI.CST_KEY = CA.CID
LEFT JOIN SILVER.ERP_LOC_A101 LA
ON  CI.CST_KEY = LA.CID
ORDER BY 1,2
------------------------------------------------------
--DATA INTEGRATION
SELECT DISTINCT 
CI.CST_GNDR,
CA.GEN,
CASE WHEN CI.CST_GNDR != 'N/A' THEN CI.CST_GNDR --CRM IS THE MASTER FOR GENDER
     ELSE COALESCE(CA.GEN, 'N/A')
END AS NEW_GEN
FROM SILVER.CRM_CUST_INFO CI
LEFT JOIN SILVER.ERP_CUST_AZ12 CA
ON  CI.CST_KEY = CA.CID
LEFT JOIN SILVER.ERP_LOC_A101 LA
ON  CI.CST_KEY = LA.CID
ORDER BY 1,2
--------------------------------------------------------------------------------
--CHECK THE QUALITY OF THIS OBJECTS
SELECT DISTINCT GENDER FROM GOLD.DIM_CUSTOMERS
-----------------------------------------------------------------
SELECT 
PN.PRD_ID,
PN.CAT_ID,
PN.PRD_KEY,
PN.PRD_NM,
PN.PRD_COST,
PN.PRD_LINE,
PN.PRD_START_DT,
PC.CAT,
PC.SUBCAT,
PC.MAINTENANCE
FROM SILVER.CRM_PRD_INFO PN
LEFT JOIN SILVER.ERP_PX_CAT_G1V2 PC
ON PN.CAT_ID = PC.ID
WHERE PRD_END_DT IS NULL --FILTERING OUT ALL HISTORICAL DATA

--CHECK 
SELECT PRD_KEY ,COUNT(*) FROM (
SELECT 
PN.PRD_ID,
PN.CAT_ID,
PN.PRD_KEY,
PN.PRD_NM,
PN.PRD_COST,
PN.PRD_LINE,
PN.PRD_START_DT,
PC.CAT,
PC.SUBCAT,
PC.MAINTENANCE
FROM SILVER.CRM_PRD_INFO PN
LEFT JOIN SILVER.ERP_PX_CAT_G1V2 PC
ON PN.CAT_ID = PC.ID
WHERE PRD_END_DT IS NULL --FILTERING OUT ALL HISTORICAL DATA
)T GROUP BY PRD_KEY
HAVING COUNT(*) > 1

----------------------------------------------------------
SELECT 
PN.PRD_ID AS PRODUCT_ID,
PN.PRD_KEY AS PRODUCT_NUMBER,
PN.PRD_NM AS PRODUCT_NAME,
PN.CAT_ID AS CATEGORY_ID,
PC.CAT AS CATEGORY,
PC.SUBCAT AS SUBCATEGORY,
PC.MAINTENANCE,
PN.PRD_COST AS COST,
PN.PRD_LINE AS PRODUCT_LINE,
PN.PRD_START_DT AS START_DATE
FROM SILVER.CRM_PRD_INFO PN
LEFT JOIN SILVER.ERP_PX_CAT_G1V2 PC
ON PN.CAT_ID = PC.ID
WHERE PRD_END_DT IS NULL --FILTERING OUT ALL HISTORICAL DATA
-----------------------------------------------------------------
SELECT * FROM GOLD.DIM_PRODUCTS
---------------------------------------------------------------------
--FOREIGN KEY INTEGRITY (DIMENSIONS)
SELECT * FROM GOLD.FACT_SALES

SELECT * FROM GOLD.FACT_SALES F
LEFT JOIN GOLD.DIM_CUSTOMERS C
ON C.CUSTOMER_KEY = F.CUSTOMER_KEY
WHERE C.CUSTOMER_KEY IS NULL

SELECT * FROM GOLD.FACT_SALES F
LEFT JOIN GOLD.DIM_CUSTOMERS C
ON C.CUSTOMER_KEY = F.CUSTOMER_KEY
LEFT JOIN GOLD.DIM_PRODUCTS P
ON P.PRODUCT_KEY = F.PRODUCT_KEY
WHERE P.PRODUCT_KEY IS NULL
